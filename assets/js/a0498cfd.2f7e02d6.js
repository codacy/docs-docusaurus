"use strict";(globalThis.webpackChunkdocusaurus=globalThis.webpackChunkdocusaurus||[]).push([[1116],{28453(e,n,t){t.d(n,{R:()=>a,x:()=>o});var s=t(96540);const i={},r=s.createContext(i);function a(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),s.createElement(r.Provider,{value:n},e.children)}},75851(e,n,t){t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>o,default:()=>h,frontMatter:()=>a,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"codacy-api/examples/triggering-dast-scans","title":"Trigger Dynamic Application Security Testing (DAST) scans","description":"Instructions on how to trigger DAST/App using the API.","source":"@site/docs/codacy-api/examples/triggering-dast-scans.mdx","sourceDirName":"codacy-api/examples","slug":"/codacy-api/examples/triggering-dast-scans","permalink":"/docs-docusaurus/docs/codacy-api/examples/triggering-dast-scans","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Trigger Dynamic Application Security Testing (DAST) scans","description":"Instructions on how to trigger DAST/App using the API."},"sidebar":"documentationSidebar","previous":{"title":"Identifying commits without coverage data","permalink":"/docs-docusaurus/docs/codacy-api/examples/identifying-commits-without-coverage-data"},"next":{"title":"Uploading DAST results to Codacy","permalink":"/docs-docusaurus/docs/codacy-api/examples/uploading-dast-results"}}');var i=t(74848),r=t(28453);const a={title:"Trigger Dynamic Application Security Testing (DAST) scans",description:"Instructions on how to trigger DAST/App using the API."},o=void 0,c={},d=[{value:"Creating targets",id:"creating-targets",level:2},{value:"Trigger DAST analysis scans",id:"trigger-dast-analysis-scans",level:2}];function l(e){const n={a:"a",admonition:"admonition",br:"br",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:"Thanks to the new app scanning capabilities available on the Security and risk management dashboard, it's now possible to automate application scanning via Codacy's API. This means that, with little effort, you'll be able to trigger app scanning on demand every time you deploy a new version of your app."}),"\n",(0,i.jsxs)(n.admonition,{type:"caution",children:[(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"App scanning is a business feature."})," If you are a Codacy Pro customer, contact our customer success team to access a short trial."]}),(0,i.jsxs)(n.p,{children:[(0,i.jsxs)(n.strong,{children:["Check your ",(0,i.jsx)(n.a,{href:"../../organizations/roles-and-permissions-for-organizations.md",children:"permissions"}),"."]})," Only git provider admins and organization managers will be able to create new targets and trigger scans (in app and via the API)."]})]}),"\n",(0,i.jsx)(n.h2,{id:"creating-targets",children:"Creating targets"}),"\n",(0,i.jsx)(n.p,{children:"Before the automation process itself, you need to create a target. Targets are individual configurations that define what Codacy will scan, including the target URL, its type (API or web application), and other type-dependent fields like OpenAPI specification and optional authentication details for API targets."}),"\n",(0,i.jsxs)(n.p,{children:["Targets only need to be created once. Note that ",(0,i.jsx)(n.strong,{children:"targets are immutable"})," \u2014 if you need to change the URL, definition, or authentication, you'll need to delete the target and create a new one."]}),"\n",(0,i.jsxs)(n.admonition,{type:"caution",children:[(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Do not run API scans on production enviroments as our API scanners may cause potential downtime."}),(0,i.jsx)(n.br,{}),"\n","Our DAST API scanner performs active security testing by sending a large number of requests to your application. When using authenticated API scanning, this activity can be even more intensive, as ZAP explores and probes more of your API surface."]}),(0,i.jsx)(n.p,{children:"Depending on how your target environment is configured, this may:"}),(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Trigger rate limiting or throttling"}),"\n",(0,i.jsx)(n.li,{children:"Appear as a high volume of traffic, similar to a load test"}),"\n",(0,i.jsx)(n.li,{children:"Lead to incomplete scan results if key endpoints are blocked or limited"}),"\n"]}),(0,i.jsxs)(n.p,{children:["We recommend running scans in a ",(0,i.jsx)(n.strong,{children:"test or staging environment"}),", or coordinating with your infrastructure team to ensure that your environment can safely handle the load."]})]}),"\n",(0,i.jsx)(n.p,{children:"To create a target, use the following API request:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'curl -X POST https://app.codacy.com/api/v3/organizations/{GIT_PROVIDER}/{ORGANIZATION}/dast/targets \\\n  -H "Content-Type: application/json" \\\n  -H "Accept: application/json" \\\n  -H "api-token: {API_KEY}" \\\n  -d \'{\n        "url": {TARGET_URL},\n        "targetType": {TARGET_TYPE},\n        "apiDefinitionUrl": {API_DEFINITION_URL},\n        "apiAuthHeaders": {\n          "{HEADER_NAME}": "{HEADER_VALUE}"\n        }\n      }\'\n'})}),"\n",(0,i.jsx)(n.p,{children:"Replace the placeholders with your own values:"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Field"}),(0,i.jsx)(n.th,{children:"Required"}),(0,i.jsx)(n.th,{children:"Description"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"API_KEY"})}),(0,i.jsx)(n.td,{children:"true"}),(0,i.jsxs)(n.td,{children:[(0,i.jsx)(n.a,{href:"../api-tokens.md#account-api-tokens",children:"Account API token"})," used to authenticate on the Codacy API"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"GIT_PROVIDER"})}),(0,i.jsx)(n.td,{children:"true"}),(0,i.jsxs)(n.td,{children:["Git provider hosting of the organization, using one of the values in the table below. ",(0,i.jsx)("br",{}),(0,i.jsx)(n.strong,{children:"Options:"})," ",(0,i.jsx)(n.code,{children:"gh"})," (GitHub Cloud), ",(0,i.jsx)(n.code,{children:"ghe"}),"(GitHub Enterprise), ",(0,i.jsx)(n.code,{children:"gl"})," (Gitlab Cloud), ",(0,i.jsx)(n.code,{children:"gle"})," (Gitlab Enterprise), ",(0,i.jsx)(n.code,{children:"bb"})," (Bitbucket Cloud), ",(0,i.jsx)(n.code,{children:"bbe"})," (Bitbucket Server)"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"ORGANIZATION"})}),(0,i.jsx)(n.td,{children:"true"}),(0,i.jsxs)(n.td,{children:["Name of the organization on the Git provider. You must have admin permissions over the organization on the Git provider.",(0,i.jsx)("br",{}),"For example, ",(0,i.jsx)(n.code,{children:"codacy"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"TARGET_URL"})}),(0,i.jsx)(n.td,{children:"true"}),(0,i.jsxs)(n.td,{children:["URL of the Web app or API that will be scanned. ",(0,i.jsx)("br",{}),"Must start with ",(0,i.jsx)(n.code,{children:"http://"})," or ",(0,i.jsx)(n.code,{children:"https://"}),(0,i.jsx)("br",{}),"For example, ",(0,i.jsx)(n.code,{children:"https://api.codacy.com/v1"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"TARGET_TYPE"})}),(0,i.jsx)(n.td,{children:"false"}),(0,i.jsxs)(n.td,{children:["Type of target to be scanned ",(0,i.jsx)("br",{})," ",(0,i.jsx)(n.strong,{children:"Options:"})," ",(0,i.jsx)(n.code,{children:"webapp"})," (default), ",(0,i.jsx)(n.code,{children:"openapi"})," or ",(0,i.jsx)(n.code,{children:"graphql"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"API_DEFINITION_URL"})}),(0,i.jsx)(n.td,{children:"false *"}),(0,i.jsxs)(n.td,{children:["The URL to a publicly accessible OpenAPI specification.",(0,i.jsx)("br",{}),"*** Required for OpenAPI targets**"]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"HEADER_NAME"})}),(0,i.jsx)(n.td,{children:"false"}),(0,i.jsxs)(n.td,{children:["Name of the authentication header. ",(0,i.jsx)("br",{}),"For example, ",(0,i.jsx)(n.code,{children:"Authentication"})]})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.strong,{children:"HEADER_VALUE"})}),(0,i.jsx)(n.td,{children:"false"}),(0,i.jsxs)(n.td,{children:["Value of the authentication header. ",(0,i.jsx)("br",{}),"For example, a token or API key"]})]})]})]}),"\n",(0,i.jsxs)(n.p,{children:["Once you create the target you'll get the target ",(0,i.jsx)(n.code,{children:"id"})," as a response. You will use it to trigger DAST scans in the next section."]}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsx)(n.p,{children:"Currently we only support one authentication header. If you need more, please let us know via support or your account representative."})}),"\n",(0,i.jsx)(n.h2,{id:"trigger-dast-analysis-scans",children:"Trigger DAST analysis scans"}),"\n",(0,i.jsxs)(n.p,{children:["Once your targets are created you can trigger an analysis by calling the '",(0,i.jsx)(n.a,{href:"https://api.codacy.com/api/api-docs#analyzedasttarget",children:"Analyze DAST target"}),"' endpoint."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'curl -X POST https://app.codacy.com/api/v3/organizations/{GIT_PROVIDER}/{ORGANIZATION}/dast/targets/{DAST_TARGET_ID}/analyze \\\n  -H "Accept: application/json" \\\n  -H "api-token: {API_KEY}"\n'})}),"\n",(0,i.jsx)(n.p,{children:"Replace the placeholders with your own values:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"API_KEY:"})," ",(0,i.jsx)(n.a,{href:"../api-tokens.md#account-api-tokens",children:"Account API token"})," used to authenticate on the Codacy API."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"GIT_PROVIDER:"})," Git provider hosting of the organization (check the table on the example above). For example, ",(0,i.jsx)(n.code,{children:"gh"})," for GitHub Cloud."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"ORGANIZATION:"})," Name of the organization on the Git provider. For example, ",(0,i.jsx)(n.code,{children:"codacy"}),". You must have admin permissions over the organization on the Git provider."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"DAST_TARGET_ID:"})," Identifier of a DAST target to analyze (obtained in the ",(0,i.jsx)(n.a,{href:"./triggering-dast-scans.md#creating-targets",children:"previous section"}),". For example, ",(0,i.jsx)(n.code,{children:"457"}),". You must have admin permissions over the organization on the Git provider."]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Scans occur asynchronously. To monitor an ongoing scan you can use the ",(0,i.jsx)(n.a,{href:"/docs-docusaurus/docs/organizations/managing-security-and-risk#app-scanning",children:"target management page in Codacy"}),". Once completed, you can access all scan results by navigating to the ",(0,i.jsx)(n.strong,{children:"Security dashboard"}),", selecting the ",(0,i.jsx)(n.strong,{children:"Findings tab"})," and filtering by ",(0,i.jsx)(n.strong,{children:"Scan types > DAST/App scanning"}),", or by clicking on a configured target to expand all of that target's results.\nAdditionaly, you can use the ",(0,i.jsx)(n.code,{children:"SearchSRMItems"})," endpoint to filter findings by their DAST target URL with the following request:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-bash",children:'curl -X POST https://app.codacy.com/api/v3/organizations/gh/codacy/security/items/search \\\n  -H "Accept: application/json" \\\n  -H "api-token: {API_KEY}" \\\n  -d \'{"statuses":["OnTrack","Overdue","DueSoon"],"dastTargetUrls":["example.com]}\'\n'})})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(l,{...e})}):l(e)}}}]);